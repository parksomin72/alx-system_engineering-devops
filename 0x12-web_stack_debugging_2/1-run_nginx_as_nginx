#!/bin/bash
# This script configures Nginx to run as the nginx user and listen on port 8080

# Stop nginx if it's already running
service nginx stop

# Remove any existing nginx processes
pkill -9 nginx

# Update nginx configuration to run as nginx user
sed -i 's/user www-data;/user nginx;/g' /etc/nginx/nginx.conf

# Restart nginx
service nginx start

# Verify nginx is running as nginx user and listening on port 8080
if ps -aux | grep nginx | grep -q nginx && nc -z 0 8080; then
    echo "Nginx is running as nginx user and listening on port 8080"
else
    echo "Nginx is not properly configured"
fi
